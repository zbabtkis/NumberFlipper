(function(e){"use strict";var t=function(e){var i=" ";return e.addClass=function(t){var s=e.className?i:"";return e.className.match(t)||(this.className=this.className+s+t),this},e.removeClass=function(e){return this.className.replace(i+e,""),this.className.replace(e,""),this},e.remove=function(){return this.parentNode&&this.parentNode.removeChild(e),this},e.hide=function(){return this.style.display="none",this},e.append=function(e){return this.appendChild(e),this},e.appendTo=function(e){return this.remove(),e.append(this),this},e.show=function(){return this.style.display="block",this},e.css=function(e,i){function s(e){var i=e.split("-"),s="";return t.each(i,function(e,t){0===e||1===e&&""===i[0]?s+=t.toLowerCase():(s+=t.slice(0,1).toUpperCase(),s+=t.slice(1).toLowerCase())}),s}function r(e,t){n.style[s(e)]=t}var n=this;return"string"==typeof e?r(e,i):"object"==typeof e&&t.each(e,r),this},e.html=function(e){return this.innerHTML=e,this},e.text=function(e){var t=document.createTextNode(e);return this.html(""),this.append(t),this},e};t.each=t.each||function(e,t){for(var i=0,s=e.length;s>i;i++)t(i,e[i])},t.Deferred=t.Deferred||function(){var e=[];return{promise:function(){return{then:function(t){e.push(t)}}},resolve:function(i){t.each(e,function(e,t){t(i)})}}},e.El=t;var i=function(e,t){this.$el=e,this.mf=t,this._domLayers=[],e.addClass("flipper"),this.increase=this.increase.bind(this),this.decrease=this.decrease.bind(this),this._events={},this.index=0,this.setLayer(i.Layers.FLIP,this.createTile(0)).show()};i.FlipRange=function(e,t){for(var i=[],s=e;t>=s;s++)i.push(s);return i},i.ProgressiveAccelleration=function(){this.speed=1},i.ProgressiveAccelleration.prototype.tick=function(){return this},i.ProgressiveAccelleration.prototype.getSpeed=function(){return this.speed},i.Direction={},i.Layers={},i.Classes={},i.Sets={},i.Direction.UP=1,i.Direction.DOWN=-1,i.Layers.MASK_ABOVE=400,i.Layers.FLIP=300,i.Layers.MASK_BELOW=200,i.Layers.NEXT=100,i.Layers.LAST=101,i.Classes[i.Layers.MASK_ABOVE]="mask",i.Classes[i.Layers.MASK_BELOW]="mask",i.Sets.SingleDigit=i.FlipRange(0,9),i.prototype.getIndex=function(){return this.index},i.prototype.setIndex=function(e){this.index=e},i.prototype.increase=function(){var e=this.index+1>=this.mf.length?0:this.index+1;this.setIndex(e)},i.prototype.decrease=function(){var e=this.index-1<=0?this.mf.length-1:this.index-1;this.setIndex(e)},i.prototype.transitionNumbers=function(e,t){var i=this.getIndex(),s=this.getIndex(e());return 0===s&&i>s&&this.trigger("loop"),{current:this.mf[i],after:this.mf[s],speed:t}},i.prototype.createTile=function(e){var i=t(document.createElement("div"));return i.addClass("tile-inner"),i.text(e),i},i.prototype.createHalfTile=function(e){return this.createTile(e).addClass("mask-inner")},i.prototype.setLayer=function(e,s){return this._domLayers[e]&&(this._domLayers[e].remove(),this._domLayers[e]=null),s?(this._domLayers[e]=t(document.createElement("div")),this._domLayers[e].hide().append(s).css("z-index",e).addClass("tile").addClass(i.Classes[e]).appendTo(this.$el),this._domLayers[e]):this},i.prototype.getLayer=function(e){return this._domLayers[e]},i.prototype.setupFlip=function(e){this.flipAccelleration=new i.ProgressiveAccelleration,this.setLayer(i.Layers.FLIP,this.createTile(e.current)).show(),this.setLayer(i.Layers.NEXT,this.createTile(e.after)).show(),this.setLayer(i.Layers.MASK_ABOVE,this.createHalfTile(e.current)).addClass("below").show(),this.setLayer(i.Layers.MASK_BELOW,this.createHalfTile(e.current)).addClass("below").show()},i.prototype.flipAway=function(e,s,r,n){var a,s=s||t.Deferred(),o=this.flipAccelleration.getSpeed();if(!n)return requestAnimationFrame(this.flipAway.bind(this,e,s,null)),s.promise();r=r||n,a=n-r;var h=this.normalRotation(a,e.speed+o,1,-90),l=this.getLayer(i.Layers.FLIP);return h=h>=-90?h:-90,this.rotateDomElement(l.children[0],h),this.flipAccelleration.tick(a),-90===h?s.resolve():void requestAnimationFrame(this.flipAway.bind(this,e,s,r))},i.prototype.setupFinalFlip=function(e){this.setLayer(i.Layers.MASK_ABOVE,this.createHalfTile(e.after)).addClass("above").show(),this.setLayer(i.Layers.FLIP,this.createTile(e.after))},i.prototype.flipIn=function(e,s,r,n){var a,s=s||t.Deferred(),o=this.flipAccelleration.getSpeed();if(!n)return requestAnimationFrame(this.flipIn.bind(this,e,s,null)),s.promise();r=r||n,a=n-r;var h=90-this.normalRotation(a,e.speed+o,1,90),l=this.getLayer(i.Layers.FLIP);return h=h>0?h:0,this.rotateDomElement(l.children[0],h),this.flipAccelleration.tick(a),l.show(),0===h?s.resolve(n):void requestAnimationFrame(this.flipIn.bind(this,e,s,r))},i.prototype.teardown=function(){this.setLayer(i.Layers.MASK_ABOVE,null),this.setLayer(i.Layers.FLIP,null),this.setLayer(i.Layers.NEXT,null),this.setLayer(i.Layers.MASK_BELOW,null)},i.prototype.rotateDomElement=function(e,i){t(e).css("-webkit-transform","rotateX("+i+"deg)")},i.prototype.normalRotation=function(e,t,i,s){return parseInt(e/1e3*t*s/i)},i.prototype.warpSpeed=function(e,t){return Math.pow(t/2-Math.abs(e-t/2)+1,1.25)},i.prototype.run=function(e,t,i){var i,s,r=this;i&&i.flip&&i.flip.speed?s=this.transitionNumbers(e,i.flip.speed):(i=i||1,s=this.transitionNumbers(e,this.warpSpeed(i,t))),this.flip=s,this.setupFlip(s),this.flipAway(s).then(function(){r.setupFinalFlip(s),r.flipIn(s).then(function(){t>i&&(r.teardown(),r.run(e,t,i+1))})})},i.prototype.on=function(e,t){this._events[e]=this._events[e]||[],this._events[e].push(t)},i.prototype.trigger=function(e,t){this._events[e]=this._events[e]||[],this._events[e].forEach(function(e){e(t)})};var s=function(e,s){var r,n,a=[];e=t(e),e.addClass("multiflip");for(var o=0;s>o;o++){var h=65*s-65*o-65;r=t(document.createElement("div")),r.css("left",h+"px"),n=new i(r,i.Sets.SingleDigit),a.push(n),r.appendTo(e),a[o-1]&&a[o-1].on("loop",n.run.bind(n,n.increase,1,a[o-1]))}this.digits=s,this.currentNumber=0,this.flippers=a};s.prototype.run=function(e){this.flipTo(this.flippers[0],e)},s.prototype.flipTo=function(e,t){var i=t-this.currentNumber;0>i&&(i=Math.pow(10,this.digits)+i),i&&(this.currentNumber=t,e.run(e.increase,Math.abs(i)))},e.NumberFlipper=s}).call(this,this);